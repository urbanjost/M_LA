<!-- -*- mode: jinja2 -*- -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="M_LA module">
    <meta name="author" content="John S. Urban" >
    <link rel="icon" href="../favicon.png">

    <title>mat_urand &ndash; M_LA</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async
            integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw=" crossorigin="anonymous"></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>

    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html">M_LA </a>
          <button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbar"
                  aria-expanded="false" aria-controls="navbar" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon">
          </button>

          <div id="navbar" class="navbar-collapse collapse">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../sourcefile/m_la.f90.html">Source File</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
            </ul>
              <div class="d-flex align-items-end flex-grow-1">
                <form action="../search.html" role="search" class="ms-auto">
                  <input type="text" class="form-control" aria-label="Search" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
                </form>
              </div>
          </div><!--/.nav-collapse -->
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>mat_urand
      <small>Function</small>
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 1.4% of total for procedures.">32 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/M_LA.f90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/m_la.f90.html'>M_LA.f90</a></li>
                <li class="breadcrumb-item"><a href='../module/m_la.html'>m_la</a></li>
            <li class="breadcrumb-item active" aria-current="page">mat_urand</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/mat_urand.html#src">mat_urand</a>
      </div>
    </div>


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  function mat_urand(iy)  
</h2>
    



    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-iy~8"></span>
              integer
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>iy</strong></td>
            <td>
                <h2 id="name">NAME</h2>
<div class="codehilite"><pre><span></span><code>mat_urand(3f) - [] uniform random number generator
LICENSE(MIT)
</code></pre></div>

<h2 id="synopsis">SYNOPSIS</h2>
<div class="codehilite"><pre><span></span><code> doubleprecision function mat_urand(iy)

  integer,intent(inout) :: iy
</code></pre></div>

<h2 id="description">DESCRIPTION</h2>
<div class="codehilite"><pre><span></span><code>mat_urand(3f) is a uniform random number generator based on theory and
suggestions given in D.E. Knuth (1969), Vol 2. The integer IY should
be initialized to an arbitrary integer prior to the first call to
mat_urand(3f). The calling program should not alter the value of IY
between subsequent calls to mat_urand(3f). Values of mat_urand(3f) will
be returned in the interval (0,1).
</code></pre></div>

<h2 id="options">OPTIONS</h2>
<div class="codehilite"><pre><span></span><code><span class="nv">IY</span><span class="w"> </span><span class="nv">seed</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">generating</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">sequence</span>.
</code></pre></div>

<h2 id="example">EXAMPLE</h2>
            </td>
        </tr>
    </tbody>
  </table>

      <h3>Return Value
        <small>
          <span class="anchor" id="variable-mat_urand"></span>
          doubleprecision
        </small>
      </h3>
      
    <br>


    
    

    
    



    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl codehilite"><pre><span></span><span class="n">doubleprecision</span><span class="w"> </span><span class="k">function </span><span class="n">mat_urand</span><span class="p">(</span><span class="n">iy</span><span class="p">)</span>
<span class="c">!&gt;</span>
<span class="c">!!##NAME</span>
<span class="c">!!    mat_urand(3f) - [] uniform random number generator</span>
<span class="c">!!    LICENSE(MIT)</span>
<span class="c">!!</span>
<span class="c">!!##SYNOPSIS</span>
<span class="c">!!</span>
<span class="c">!!     doubleprecision function mat_urand(iy)</span>
<span class="c">!!</span>
<span class="c">!!      integer,intent(inout) :: iy</span>
<span class="c">!!</span>
<span class="c">!!##DESCRIPTION</span>
<span class="c">!!    mat_urand(3f) is a uniform random number generator based on theory and</span>
<span class="c">!!    suggestions given in D.E. Knuth (1969), Vol 2. The integer IY should</span>
<span class="c">!!    be initialized to an arbitrary integer prior to the first call to</span>
<span class="c">!!    mat_urand(3f). The calling program should not alter the value of IY</span>
<span class="c">!!    between subsequent calls to mat_urand(3f). Values of mat_urand(3f) will</span>
<span class="c">!!    be returned in the interval (0,1).</span>
<span class="c">!!</span>
<span class="c">!!##OPTIONS</span>
<span class="c">!!    IY seed for generating a sequence.</span>
<span class="c">!!</span>
<span class="c">!!##EXAMPLE</span>
<span class="c">!!</span>
<span class="kt">integer</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">iy</span>
<span class="kt">integer</span><span class="p">,</span><span class="k">save</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">ia</span>
<span class="kt">integer</span><span class="p">,</span><span class="k">save</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">ic</span>
<span class="kt">integer</span><span class="p">,</span><span class="k">save</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">itwo</span><span class="o">=</span><span class="mi">2</span>
<span class="kt">integer</span><span class="p">,</span><span class="k">save</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">m2</span><span class="o">=</span><span class="mi">0</span>
<span class="kt">integer</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">m</span>
<span class="kt">integer</span><span class="p">,</span><span class="k">save</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">mic</span>
<span class="n">doubleprecision</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">halfm</span>
<span class="n">doubleprecision</span><span class="p">,</span><span class="k">save</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">s</span>
<span class="n">doubleprecision</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="nb">datan</span>
<span class="n">doubleprecision</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="nb">dsqrt</span>
<span class="c">!-----------------------------------------------------------------------</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m2</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">                                </span><span class="c">! if first entry, compute machine integer word length</span>
<span class="w">      </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">infinite</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="k">         </span><span class="n">m2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m</span>
<span class="w">         </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">itwo</span><span class="o">*</span><span class="n">m2</span>
<span class="w">         </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">m</span><span class="w"> </span><span class="p">.</span><span class="n">le</span><span class="p">.</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">infinite</span>
<span class="w">      </span><span class="k">enddo </span><span class="n">infinite</span>
<span class="w">      </span><span class="n">halfm</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">m2</span>
<span class="w">      </span><span class="n">ia</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">8</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">halfm</span><span class="o">*</span><span class="nb">datan</span><span class="p">(</span><span class="mf">1.d0</span><span class="p">)</span><span class="o">/</span><span class="mf">8.d0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="w">          </span><span class="c">! compute multiplier and increment for linear congruential method</span>
<span class="w">      </span><span class="n">ic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">halfm</span><span class="o">*</span><span class="p">(</span><span class="mf">0.5d0</span><span class="o">-</span><span class="nb">dsqrt</span><span class="p">(</span><span class="mf">3.d0</span><span class="p">)</span><span class="o">/</span><span class="mf">6.d0</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">      </span><span class="n">mic</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">m2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ic</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m2</span>
<span class="w">      </span><span class="n">s</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.5d0</span><span class="o">/</span><span class="n">halfm</span><span class="w">                                 </span><span class="c">! s is the scale factor for converting to floating point</span>
<span class="w">   </span><span class="k">endif</span>
<span class="w">   </span><span class="c">! compute next random number</span>
<span class="w">   </span><span class="n">iy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iy</span><span class="o">*</span><span class="n">ia</span>

<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iy</span><span class="w"> </span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="w"> </span><span class="n">mic</span><span class="p">)</span><span class="w"> </span><span class="n">iy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m2</span><span class="w">     </span><span class="c">! this statement is for computers which do not allow integer overflow on addition</span>

<span class="w">   </span><span class="n">iy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ic</span>

<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iy</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="n">gt</span><span class="p">.</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="n">iy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iy</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">m2</span><span class="w">    </span><span class="c">! this statement is for computers where the word length for addition is greater than</span>
<span class="w">                                            </span><span class="c">! for multiplication</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iy</span><span class="w"> </span><span class="p">.</span><span class="n">lt</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">iy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">iy</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">m2</span><span class="w">       </span><span class="c">! this statement is for computers where integer overflow affects the sign bit</span>

<span class="w">   </span><span class="n">mat_urand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">dble</span><span class="p">(</span><span class="n">iy</span><span class="p">)</span><span class="o">*</span><span class="n">s</span>
<span class="k">end function </span><span class="n">mat_urand</span>
</pre></div>

    </section>
    <br>
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              M_LA
 was developed by John S. Urban<br>              &copy; 2025 
</p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
 on 2025-03-31 12:28 +0000             </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>
  </body>
</html>